<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IDK Chores</title>
    <style>
        :root {
            --primary-start: #2c5f7a;
            --primary-end: #1a3a4a;
            --accent-primary: #0d9488;
            --accent-secondary: #0f766e;
            --accent-bg: #f0fdfa;
            --balance-start: #0d9488;
            --balance-end: #0f766e;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, var(--primary-start) 0%, var(--primary-end) 100%); min-height: 100vh; }
        .container { max-width: 500px; margin: 0 auto; min-height: 100vh; background: white; box-shadow: 0 0 50px rgba(0,0,0,0.2); }
        .hidden { display: none; }
        .login-screen { padding: 40px 20px; text-align: center; min-height: 100vh; display: flex; flex-direction: column; justify-content: center; align-items: center; background: linear-gradient(135deg, var(--primary-start) 0%, var(--primary-end) 100%); }
        .login-screen h1 { color: white; font-size: 3em; margin-bottom: 15px; text-shadow: 2px 2px 4px rgba(0,0,0,0.2); }
        .login-screen p { color: rgba(255,255,255,0.9); margin-bottom: 40px; font-size: 0.95em; font-style: italic; line-height: 1.4; max-width: 300px; }
        .google-signin-btn { background: white; color: #333; padding: 15px 40px; border: none; border-radius: 8px; font-size: 1em; font-weight: 600; cursor: pointer; display: inline-flex; align-items: center; gap: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.15); transition: all 0.2s; }
        .google-signin-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.2); }
        .google-icon { width: 24px; height: 24px; }
        .header { background: linear-gradient(135deg, var(--primary-start) 0%, var(--primary-end) 100%); color: white; padding: 25px 20px; display: flex; justify-content: space-between; align-items: center; }
        .header-left, .header-right { display: flex; align-items: center; gap: 15px; }
        .theme-btn, .logout-btn { background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.3); color: white; padding: 8px 12px; border-radius: 8px; cursor: pointer; transition: background 0.2s; }
        .theme-btn:hover, .logout-btn:hover { background: rgba(255,255,255,0.3); }
        .user-avatar { width: 40px; height: 40px; border-radius: 50%; border: 2px solid white; }
        .main-content { padding: 100px 20px 80px 20px; }
        .stats-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 25px; }
        .stat-card { background: linear-gradient(135deg, var(--balance-start) 0%, var(--balance-end) 100%); color: white; padding: 20px; border-radius: 16px; text-align: center; }
        .stat-card.alt { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); }
        .stat-value { font-size: 2em; font-weight: 700; margin-bottom: 5px; }
        .stat-label { font-size: 0.85em; opacity: 0.9; }
        .nav-tabs { display: flex; gap: 10px; margin-bottom: 20px; overflow-x: auto; }
        .nav-tab { flex: 1; min-width: 100px; padding: 12px 16px; background: white; border: 2px solid #e0e0e0; border-radius: 12px; cursor: pointer; font-weight: 600; text-align: center; transition: all 0.2s; }
        .nav-tab:hover { border-color: var(--accent-primary); }
        .nav-tab.active { background: var(--accent-bg); border-color: var(--accent-primary); color: var(--accent-primary); }
        .card { background: white; border: 2px solid #e0e0e0; border-radius: 16px; padding: 20px; margin-bottom: 15px; cursor: pointer; transition: all 0.2s; }
        .card:hover { border-color: var(--accent-primary); box-shadow: 0 3px 10px rgba(13, 148, 136, 0.2); transform: translateY(-2px); }
        .card.pending { border-color: #f59e0b; background: #fffbeb; }
        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .card-title { font-size: 1.2em; font-weight: 600; color: #333; display: flex; align-items: center; gap: 8px; }
        .card-badge { background: var(--accent-primary); color: white; padding: 4px 12px; border-radius: 12px; font-size: 0.85em; font-weight: 600; }
        .card-badge.points { background: #f59e0b; }
        .card-body { color: #666; font-size: 0.9em; line-height: 1.4; }
        .card-meta { display: flex; gap: 15px; margin-top: 10px; font-size: 0.85em; color: #999; }
        .card-actions { display: flex; gap: 10px; margin-top: 15px; }
        .card-btn { flex: 1; padding: 10px; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.2s; }
        .card-btn.primary { background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%); color: white; }
        .card-btn.success { background: #10b981; color: white; }
        .card-btn.danger { background: #ef4444; color: white; }
        .action-btn, .add-btn { width: 100%; padding: 15px; border-radius: 12px; font-size: 0.95em; font-weight: 600; cursor: pointer; transition: all 0.2s; margin-bottom: 15px; }
        .action-btn { border: none; color: white; background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%); }
        .action-btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(13, 148, 136, 0.4); }
        .add-btn { background: white; border: 2px dashed var(--accent-primary); color: var(--accent-primary); }
        .add-btn:hover { background: var(--accent-bg); }
        .modal { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.6); z-index: 1000; align-items: center; justify-content: center; padding: 20px; }
        .modal.active { display: flex; }
        .modal-content { background: white; border-radius: 20px; padding: 30px 20px; max-width: 400px; width: 100%; max-height: 80vh; overflow-y: auto; }
        .modal-content h2 { color: #333; margin-bottom: 20px; font-size: 1.5em; }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; color: #666; margin-bottom: 8px; font-weight: 600; font-size: 0.9em; }
        .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 1em; font-family: inherit; transition: border-color 0.2s; }
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus { outline: none; border-color: var(--accent-primary); }
        .form-group textarea { resize: vertical; min-height: 80px; }
        .points-picker { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
        .points-btn { padding: 15px; border: 2px solid #e0e0e0; background: white; border-radius: 10px; font-size: 1.2em; font-weight: 600; cursor: pointer; transition: all 0.2s; }
        .points-btn:hover { border-color: var(--accent-primary); }
        .points-btn.selected { border-color: var(--accent-primary); background: var(--accent-bg); color: var(--accent-primary); }
        .modal-buttons { display: flex; gap: 10px; margin-top: 25px; }
        .modal-btn { flex: 1; padding: 15px; border: none; border-radius: 12px; font-size: 1em; font-weight: 600; cursor: pointer; transition: all 0.2s; }
        .modal-btn.primary { background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%); color: white; }
        .modal-btn.primary:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(13, 148, 136, 0.4); }
        .modal-btn.secondary { background: #f0f0f0; color: #666; }
        .modal-btn.secondary:hover { background: #e0e0e0; }
        .theme-option { display: flex; align-items: center; gap: 15px; padding: 15px; border: 2px solid #e0e0e0; border-radius: 12px; margin-bottom: 10px; cursor: pointer; transition: all 0.2s; }
        .theme-option:hover { border-color: var(--accent-primary); background: #f9fafb; }
        .theme-preview { width: 80px; height: 50px; border-radius: 8px; display: flex; overflow: hidden; }
        .theme-preview-color { flex: 1; }
        .theme-name { font-weight: 600; color: #333; }
        .setup-screen { padding: 40px 20px; max-width: 500px; margin: 0 auto; }
        .setup-screen h2 { color: white; margin-bottom: 30px; text-align: center; }
        .setup-card { background: white; border-radius: 20px; padding: 30px 20px; margin-bottom: 20px; }
        .member-item { display: flex; justify-content: space-between; align-items: center; padding: 12px; background: #f9fafb; border-radius: 10px; margin-bottom: 10px; }
        .member-info { flex: 1; }
        .member-name { font-weight: 600; color: #333; }
        .member-email { font-size: 0.85em; color: #999; }
        .member-role, .member-status { padding: 4px 12px; border-radius: 12px; font-size: 0.85em; font-weight: 600; }
        .member-role.parent { background: #dbeafe; color: #1e40af; }
        .member-role.child { background: #fce7f3; color: #be185d; }
        .member-status.pending { background: #fef3c7; color: #92400e; }
        .member-status.active { background: #d1fae5; color: #065f46; }
        .remove-btn { background: #fee2e2; color: #dc2626; border: none; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 0.85em; font-weight: 600; }
        .empty-state { text-align: center; padding: 40px 20px; color: #999; }
        .empty-state-icon { font-size: 3em; margin-bottom: 15px; }
        .footer { position: fixed; bottom: 0; left: 0; right: 0; background: #333; color: white; padding: 12px 20px; text-align: center; font-size: 0.85em; z-index: 999; box-shadow: 0 -2px 10px rgba(0,0,0,0.1); }
        .footer a { color: #a8edea; text-decoration: none; cursor: pointer; margin-left: 5px; }
        .footer a:hover { text-decoration: underline; }
        .disclaimer-drawer { position: fixed; bottom: 0; left: 0; right: 0; background: white; max-height: 0; overflow: hidden; transition: max-height 0.3s ease; z-index: 1001; box-shadow: 0 -5px 20px rgba(0,0,0,0.3); }
        .disclaimer-drawer.open { max-height: 80vh; overflow-y: auto; }
        .disclaimer-content { padding: 30px 20px 80px 20px; max-width: 600px; margin: 0 auto; }
        .disclaimer-content h3 { color: #333; margin-bottom: 20px; font-size: 1.5em; text-align: center; }
        .disclaimer-content p { color: #666; line-height: 1.6; margin-bottom: 15px; text-align: justify; }
        .disclaimer-close { position: absolute; top: 15px; right: 15px; background: none; border: none; font-size: 1.8em; cursor: pointer; color: #999; padding: 5px 10px; }
        .disclaimer-close:hover { color: #333; }
        .disclaimer-overlay { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1000; }
        .disclaimer-overlay.active { display: block; }
        @media (max-width: 480px) { .stats-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div id="loginScreen" class="login-screen">
        <h1>‚úÖ IDK Chores</h1>
        <p>Track chores, build streaks, earn points together as a family!</p>
        <button class="google-signin-btn" onclick="signInWithGoogle()">
            <svg class="google-icon" viewBox="0 0 24 24">
                <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
            </svg>
            Sign in with Google
        </button>
    </div>

    <div id="setupScreen" class="setup-screen hidden">
        <h2>üè† Set Up Your Family</h2>
        <div class="setup-card">
            <h3 style="margin-bottom: 20px;">Create Your Family Account</h3>
            <div class="form-group">
                <label>Family Name</label>
                <input type="text" id="familyNameInput" placeholder="The Smith Family">
            </div>
            <button class="action-btn" onclick="createFamily()">Create Family</button>
        </div>
    </div>

    <div id="mainApp" class="container hidden">
        <div class="header">
            <div class="header-left">
                <button class="theme-btn" onclick="showThemeModal()" title="Change Theme">üé®</button>
                <span style="margin-left: 15px; font-size: 1.2em; font-weight: 600;">IDK Chores</span>
            </div>
            <div class="header-right">
                <img id="userAvatar" class="user-avatar" src="" alt="User">
                <button class="logout-btn" onclick="signOut()">Logout</button>
            </div>
        </div>

        <div class="main-content">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="todayPoints">0</div>
                    <div class="stat-label">Points Today</div>
                </div>
                <div class="stat-card alt">
                    <div class="stat-value" id="weekPoints">0</div>
                    <div class="stat-label">This Week</div>
                </div>
                <div class="stat-card" id="pendingCard" style="display: none;">
                    <div class="stat-value" id="pendingCount">0</div>
                    <div class="stat-label">Pending Approvals</div>
                </div>
                <div class="stat-card alt" id="streakCard">
                    <div class="stat-value" id="bestStreak">0</div>
                    <div class="stat-label">Best Streak üî•</div>
                </div>
            </div>

            <div class="nav-tabs">
                <div class="nav-tab active" onclick="switchTab('chores')">Chores</div>
                <div class="nav-tab" onclick="switchTab('tasks')">Tasks</div>
                <div class="nav-tab" id="approvalsTab" onclick="switchTab('approvals')" style="display: none;">Approvals</div>
                <div class="nav-tab" onclick="switchTab('settings')">Settings</div>
            </div>

            <div id="choresTab" class="tab-content">
                <button class="add-btn" onclick="showModal('addChoreModal')" id="addChoreBtn">+ Add Chore</button>
                <div id="choresList"></div>
            </div>

            <div id="tasksTab" class="tab-content hidden">
                <button class="add-btn" onclick="showModal('addTaskModal')" id="addTaskBtn">+ Add Task</button>
                <div id="tasksList"></div>
            </div>

            <div id="approvalsTabContent" class="tab-content hidden">
                <div id="approvalsList"></div>
            </div>

            <div id="settingsTab" class="tab-content hidden">
                <div class="card" style="cursor: default;">
                    <div class="card-header">
                        <div class="card-title">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Family Members</div>
                    </div>
                    <div id="familyMembersList"></div>
                    <button class="add-btn" onclick="showModal('addMemberModal')" id="addMemberBtn">+ Add Family Member</button>
                </div>

                <div class="card" style="cursor: default;" id="parentSettings">
                    <div class="card-header">
                        <div class="card-title">‚öôÔ∏è Family Settings</div>
                    </div>
                    <div class="card-body">
                        <p><strong>Streaks:</strong> <span id="streaksSetting">Enabled</span></p>
                        <p><strong>Kids Can Create Tasks:</strong> <span id="kidTasksSetting">Yes</span></p>
                    </div>
                </div>

                <div class="card" style="cursor: default;">
                    <div class="card-header">
                        <div class="card-title">üìä My Stats</div>
                    </div>
                    <div class="card-body">
                        <p><strong>Lifetime Points:</strong> <span id="lifetimePoints">0</span></p>
                        <p><strong>This Month:</strong> <span id="monthPoints">0</span></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="addChoreModal" class="modal">
        <div class="modal-content">
            <h2>Add Chore</h2>
            <div class="form-group">
                <label>Chore Name</label>
                <input type="text" id="choreName" placeholder="Take out trash">
            </div>
            <div class="form-group">
                <label>Description</label>
                <textarea id="choreDescription" placeholder="What needs to be done?"></textarea>
            </div>
            <div class="form-group">
                <label>Points Value</label>
                <div class="points-picker">
                    <button type="button" class="points-btn" onclick="selectPoints(1, this)">1</button>
                    <button type="button" class="points-btn" onclick="selectPoints(2, this)">2</button>
                    <button type="button" class="points-btn selected" onclick="selectPoints(3, this)">3</button>
                    <button type="button" class="points-btn" onclick="selectPoints(5, this)">5</button>
                    <button type="button" class="points-btn" onclick="selectPoints(8, this)">8</button>
                    <button type="button" class="points-btn" onclick="selectPoints(13, this)">13</button>
                </div>
            </div>
            <div class="form-group">
                <label>Frequency</label>
                <select id="choreFrequency">
                    <option value="daily">Daily</option>
                    <option value="weekly">Weekly</option>
                    <option value="asneeded">As Needed</option>
                </select>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn secondary" onclick="closeModal('addChoreModal')">Cancel</button>
                <button class="modal-btn primary" onclick="addChore()">Add Chore</button>
            </div>
        </div>
    </div>

    <div id="addTaskModal" class="modal">
        <div class="modal-content">
            <h2>Add Task</h2>
            <div class="form-group">
                <label>Task Title</label>
                <input type="text" id="taskTitle" placeholder="Clean garage">
            </div>
            <div class="form-group">
                <label>Points Value</label>
                <div class="points-picker">
                    <button type="button" class="points-btn" onclick="selectTaskPoints(1, this)">1</button>
                    <button type="button" class="points-btn" onclick="selectTaskPoints(2, this)">2</button>
                    <button type="button" class="points-btn selected" onclick="selectTaskPoints(3, this)">3</button>
                    <button type="button" class="points-btn" onclick="selectTaskPoints(5, this)">5</button>
                    <button type="button" class="points-btn" onclick="selectTaskPoints(8, this)">8</button>
                    <button type="button" class="points-btn" onclick="selectTaskPoints(13, this)">13</button>
                </div>
            </div>
            <div class="form-group">
                <label>Assign To</label>
                <select id="taskAssignee"></select>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn secondary" onclick="closeModal('addTaskModal')">Cancel</button>
                <button class="modal-btn primary" onclick="addTask()">Add Task</button>
            </div>
        </div>
    </div>

    <div id="addMemberModal" class="modal">
        <div class="modal-content">
            <h2>Add Family Member</h2>
            <div class="form-group">
                <label>Email Address</label>
                <input type="email" id="memberEmail" placeholder="kid@gmail.com">
            </div>
            <div class="form-group">
                <label>Display Name</label>
                <input type="text" id="memberName" placeholder="Alex">
            </div>
            <div class="form-group">
                <label>Role</label>
                <select id="memberRole">
                    <option value="child">Child</option>
                    <option value="parent">Parent</option>
                </select>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn secondary" onclick="closeModal('addMemberModal')">Cancel</button>
                <button class="modal-btn primary" onclick="addFamilyMember()">Send Invite</button>
            </div>
        </div>
    </div>

    <div id="completeChoreModal" class="modal">
        <div class="modal-content">
            <h2>Mark Chore Complete</h2>
            <div id="completeChoreInfo"></div>
            <div class="form-group">
                <label>Notes (Optional)</label>
                <textarea id="choreNotes" placeholder="Any notes?"></textarea>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn secondary" onclick="closeModal('completeChoreModal')">Cancel</button>
                <button class="modal-btn primary" onclick="submitChoreCompletion()">Submit for Approval</button>
            </div>
        </div>
    </div>

    <div id="reviewModal" class="modal">
        <div class="modal-content">
            <h2>Review Submission</h2>
            <div id="reviewInfo"></div>
            <div class="form-group" id="rejectionReasonGroup" style="display: none;">
                <label>Rejection Reason</label>
                <textarea id="rejectionReason" placeholder="Why is this being rejected?"></textarea>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn secondary" onclick="closeModal('reviewModal')">Cancel</button>
                <button class="modal-btn danger" onclick="reviewSubmission('reject')">Reject</button>
                <button class="modal-btn success" onclick="reviewSubmission('approve')">Approve</button>
            </div>
        </div>
    </div>

    <!-- Theme Modal -->
    <div id="themeModal" class="modal">
        <div class="modal-content">
            <h2>Choose Your Vibe</h2>
            <div class="theme-option" onclick="setTheme('default')">
                <div class="theme-preview">
                    <div class="theme-preview-color" style="background: #2c5f7a"></div>
                    <div class="theme-preview-color" style="background: #0d9488"></div>
                    <div class="theme-preview-color" style="background: #f59e0b"></div>
                </div>
                <div class="theme-name">Teal & Navy (Default)</div>
            </div>
            <div class="theme-option" onclick="setTheme('classic')">
                <div class="theme-preview">
                    <div class="theme-preview-color" style="background: #000"></div>
                    <div class="theme-preview-color" style="background: #fff; border: 1px solid #ddd;"></div>
                    <div class="theme-preview-color" style="background: #000"></div>
                </div>
                <div class="theme-name">Classic Black & White</div>
            </div>
            <div class="theme-option" onclick="setTheme('ocean')">
                <div class="theme-preview">
                    <div class="theme-preview-color" style="background: #0c4a6e"></div>
                    <div class="theme-preview-color" style="background: #0ea5e9"></div>
                    <div class="theme-preview-color" style="background: #06b6d4"></div>
                </div>
                <div class="theme-name">Ocean Blue</div>
            </div>
            <div class="theme-option" onclick="setTheme('royal')">
                <div class="theme-preview">
                    <div class="theme-preview-color" style="background: #1e3a8a"></div>
                    <div class="theme-preview-color" style="background: #6366f1"></div>
                    <div class="theme-preview-color" style="background: #a855f7"></div>
                </div>
                <div class="theme-name">Royal Purple & Blue</div>
            </div>
            <div class="theme-option" onclick="setTheme('purple')">
                <div class="theme-preview">
                    <div class="theme-preview-color" style="background: #581c87"></div>
                    <div class="theme-preview-color" style="background: #a855f7"></div>
                    <div class="theme-preview-color" style="background: #ec4899"></div>
                </div>
                <div class="theme-name">Deep Purple</div>
            </div>
            <div class="theme-option" onclick="setTheme('pink')">
                <div class="theme-preview">
                    <div class="theme-preview-color" style="background: #fce7f3"></div>
                    <div class="theme-preview-color" style="background: #ec4899"></div>
                    <div class="theme-preview-color" style="background: #fff"></div>
                </div>
                <div class="theme-name">Light Pink & White</div>
            </div>
            <div class="theme-option" onclick="setTheme('monochrome')">
                <div class="theme-preview">
                    <div class="theme-preview-color" style="background: #000"></div>
                    <div class="theme-preview-color" style="background: #ef4444"></div>
                    <div class="theme-preview-color" style="background: #fff"></div>
                </div>
                <div class="theme-name">Black Red White</div>
            </div>
            <div class="theme-option" onclick="setTheme('forest')">
                <div class="theme-preview">
                    <div class="theme-preview-color" style="background: #064e3b"></div>
                    <div class="theme-preview-color" style="background: #10b981"></div>
                    <div class="theme-preview-color" style="background: #fbbf24"></div>
                </div>
                <div class="theme-name">Forest Green</div>
            </div>
            <div class="theme-option" onclick="setTheme('sunset')">
                <div class="theme-preview">
                    <div class="theme-preview-color" style="background: #7c2d12"></div>
                    <div class="theme-preview-color" style="background: #f97316"></div>
                    <div class="theme-preview-color" style="background: #fbbf24"></div>
                </div>
                <div class="theme-name">Sunset Orange</div>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn secondary" onclick="closeModal('themeModal')">Close</button>
            </div>
        </div>
    </div>

    <div id="disclaimerOverlay" class="disclaimer-overlay" onclick="closeDisclaimer()"></div>
    <div id="disclaimerDrawer" class="disclaimer-drawer">
        <button class="disclaimer-close" onclick="closeDisclaimer()">√ó</button>
        <div class="disclaimer-content">
            <h3>Disclaimer</h3>
            <p>IDK Chores is provided for personal family organization purposes only. Parents are solely responsible for age-appropriate chores and supervision.</p>
            <p>Logic Nerds assumes no liability for family dynamics or any consequences arising from chore assignments. This software is provided "as is" without warranty.</p>
        </div>
    </div>

    <div class="footer">
        ¬© 2026 Logic Nerds. All Rights Reserved. | <a onclick="openDisclaimer()">Disclaimer</a>
    </div>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged, signOut as firebaseSignOut } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getFirestore, collection, addDoc, updateDoc, deleteDoc, doc, query, where, getDocs, onSnapshot, serverTimestamp, getDoc, Timestamp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        const firebaseConfig = {
            apiKey: "AIzaSyDtBO48uBogqcdv69VO9IH7MIG8Kb1YG10",
            authDomain: "idk-money-tracker.firebaseapp.com",
            projectId: "idk-money-tracker",
            storageBucket: "idk-money-tracker.firebasestorage.app",
            messagingSenderId: "1033439716188",
            appId: "1:1033439716188:web:ebf8c149f68d3d568f9799"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        let currentUser = null, currentFamily = null, currentMember = null;
        let familyMembers = [], chores = [], tasks = [], submissions = [], pointsHistory = [];
        let selectedPoints = 3, selectedTaskPoints = 3, selectedChore = null, selectedSubmission = null;
        let unsubAll = [];

        // Auth functions
        async function signInWithGoogle() {
            const provider = new GoogleAuthProvider();
            try {
                await signInWithPopup(auth, provider);
            } catch (error) {
                console.error('Sign in error:', error);
                alert('Sign in failed. Please try again.');
            }
        }

        async function signOut() {
            if (confirm('Are you sure you want to sign out?')) {
                try {
                    unsubAll.forEach(u => u());
                    await firebaseSignOut(auth);
                } catch (error) {
                    console.error('Sign out error:', error);
                    alert('Sign out failed. Please try again.');
                }
            }
        }

        // Make functions globally available
        window.signInWithGoogle = signInWithGoogle;
        window.signOut = signOut;

        onAuthStateChanged(auth, async (user) => {
            if (user) { currentUser = user; await checkFamilyStatus(); }
            else { currentUser = null; showScreen('login'); }
        });

        async function checkFamilyStatus() {
            try {
                const fq = query(collection(db, 'families'), where('ownerId', '==', currentUser.uid));
                const fs = await getDocs(fq);
                if (!fs.empty) {
                    currentFamily = { id: fs.docs[0].id, ...fs.docs[0].data() };
                    await loadMember(); showScreen('main'); loadAll(); return;
                }
                const mq = query(collection(db, 'familyMembers'), where('email', '==', currentUser.email));
                const ms = await getDocs(mq);
                if (!ms.empty) {
                    const md = ms.docs[0].data();
                    if (md.status === 'pending' && !md.userId) {
                        await updateDoc(doc(db, 'familyMembers', ms.docs[0].id), {
                            userId: currentUser.uid, status: 'active', joinedAt: serverTimestamp()
                        });
                    }
                    const fd = await getDoc(doc(db, 'families', md.familyId));
                    if (fd.exists()) {
                        currentFamily = { id: fd.id, ...fd.data() };
                        await loadMember(); showScreen('main'); loadAll(); return;
                    }
                }
                showScreen('setup');
            } catch (e) { console.error(e); alert('Error loading family'); }
        }

        async function loadMember() {
            const q = query(collection(db, 'familyMembers'), where('familyId', '==', currentFamily.id), where('userId', '==', currentUser.uid));
            const s = await getDocs(q);
            if (!s.empty) currentMember = { id: s.docs[0].id, ...s.docs[0].data() };
        }

        window.createFamily = async () => {
            const name = document.getElementById('familyNameInput').value.trim();
            if (!name) return alert('Enter family name');
            try {
                const fr = await addDoc(collection(db, 'families'), {
                    ownerId: currentUser.uid, familyName: name, createdAt: serverTimestamp(),
                    settings: { streaksEnabled: true, goalsEnabled: false, kidsCanCreateTasks: true, pointsSet: [1,2,3,5,8,13] }
                });
                await addDoc(collection(db, 'familyMembers'), {
                    familyId: fr.id, userId: currentUser.uid, email: currentUser.email,
                    displayName: currentUser.displayName || 'Parent', role: 'parent', status: 'active',
                    invitedAt: serverTimestamp(), joinedAt: serverTimestamp(), settings: { streaksEnabled: true }
                });
                await checkFamilyStatus();
            } catch (e) { console.error(e); alert('Failed to create family'); }
        };

        function loadAll() {
            unsubAll.forEach(u => u()); unsubAll = [];
            
            unsubAll.push(onSnapshot(query(collection(db, 'familyMembers'), where('familyId', '==', currentFamily.id)), s => {
                familyMembers = []; s.forEach(d => familyMembers.push({ id: d.id, ...d.data() }));
                updateMembers(); updateAssignees();
            }));
            
            unsubAll.push(onSnapshot(query(collection(db, 'chores'), where('familyId', '==', currentFamily.id)), s => {
                chores = []; s.forEach(d => chores.push({ id: d.id, ...d.data() })); updateChores();
            }));
            
            unsubAll.push(onSnapshot(query(collection(db, 'tasks'), where('familyId', '==', currentFamily.id)), s => {
                tasks = []; s.forEach(d => tasks.push({ id: d.id, ...d.data() })); updateTasks();
            }));
            
            unsubAll.push(onSnapshot(query(collection(db, 'choreSubmissions'), where('familyId', '==', currentFamily.id)), s => {
                submissions = []; s.forEach(d => submissions.push({ id: d.id, ...d.data() })); updateApprovals(); updateStats();
            }));
            
            unsubAll.push(onSnapshot(query(collection(db, 'pointsLedger'), where('familyId', '==', currentFamily.id)), s => {
                pointsHistory = []; s.forEach(d => pointsHistory.push({ id: d.id, ...d.data() })); updateStats();
            }));
            
            updateUI();
        }

        function updateUI() {
            if (!currentMember) return;
            const isParent = currentMember.role === 'parent';
            document.getElementById('parentSettings').style.display = isParent ? 'block' : 'none';
            document.getElementById('addMemberBtn').style.display = isParent ? 'block' : 'none';
            document.getElementById('addChoreBtn').style.display = isParent ? 'block' : 'none';
            document.getElementById('approvalsTab').style.display = isParent ? 'block' : 'none';
            document.getElementById('pendingCard').style.display = isParent ? 'block' : 'none';
            document.getElementById('addTaskBtn').style.display = (isParent || currentFamily.settings.kidsCanCreateTasks) ? 'block' : 'none';
            
            document.getElementById('streaksSetting').textContent = currentFamily.settings.streaksEnabled ? 'Enabled' : 'Disabled';
            document.getElementById('kidTasksSetting').textContent = currentFamily.settings.kidsCanCreateTasks ? 'Yes' : 'No';
        }

        function updateStats() {
            const up = pointsHistory.filter(p => p.userId === currentUser.uid);
            const now = new Date(), sod = new Date(now.getFullYear(), now.getMonth(), now.getDate());
            const sow = new Date(now); sow.setDate(now.getDate() - now.getDay()); sow.setHours(0,0,0,0);
            const som = new Date(now.getFullYear(), now.getMonth(), 1);
            
            document.getElementById('todayPoints').textContent = up.filter(p => p.awardedAt && p.awardedAt.toDate() >= sod).reduce((s, p) => s + p.points, 0);
            document.getElementById('weekPoints').textContent = up.filter(p => p.awardedAt && p.awardedAt.toDate() >= sow).reduce((s, p) => s + p.points, 0);
            document.getElementById('monthPoints').textContent = up.filter(p => p.awardedAt && p.awardedAt.toDate() >= som).reduce((s, p) => s + p.points, 0);
            document.getElementById('lifetimePoints').textContent = up.reduce((s, p) => s + p.points, 0);
            
            if (currentMember?.role === 'parent') {
                const pc = submissions.filter(s => s.status === 'pending').length + tasks.filter(t => t.status === 'submitted').length;
                document.getElementById('pendingCount').textContent = pc;
            }
        }

        function updateChores() {
            const list = document.getElementById('choresList');
            const vc = chores.filter(c => c.isActive && (c.assignedTo.length === 0 || c.assignedTo.includes(currentUser.uid)));
            if (vc.length === 0) {
                list.innerHTML = '<div class="empty-state"><div class="empty-state-icon">üßπ</div><p>No chores yet</p></div>';
                return;
            }
            list.innerHTML = vc.map(c => `
                <div class="card" onclick="showCompleteChore('${c.id}')">
                    <div class="card-header">
                        <div class="card-title">${c.name}</div>
                        <span class="card-badge points">${c.points} pts</span>
                    </div>
                    <div class="card-body">${c.description || ''}<div class="card-meta"><span>üìÖ ${c.frequency}</span></div></div>
                </div>
            `).join('');
        }

        function updateTasks() {
            const list = document.getElementById('tasksList');
            const vt = tasks.filter(t => t.assignedTo === currentUser.uid || t.createdBy === currentUser.uid);
            if (vt.length === 0) {
                list.innerHTML = '<div class="empty-state"><div class="empty-state-icon">üìã</div><p>No tasks yet</p></div>';
                return;
            }
            list.innerHTML = vt.map(t => {
                const sc = t.status === 'submitted' ? 'pending' : '';
                const cc = t.assignedTo === currentUser.uid && t.status === 'open';
                return `
                    <div class="card ${sc}">
                        <div class="card-header">
                            <div class="card-title">${t.title}</div>
                            <span class="card-badge points">${t.points} pts</span>
                        </div>
                        <div class="card-body"><div class="card-meta"><span>Status: ${t.status}</span></div></div>
                        ${cc ? `<div class="card-actions"><button class="card-btn primary" onclick="event.stopPropagation(); completeTask('${t.id}')">Complete</button></div>` : ''}
                    </div>
                `;
            }).join('');
        }

        function updateApprovals() {
            const list = document.getElementById('approvalsList');
            const ps = submissions.filter(s => s.status === 'pending');
            const pt = tasks.filter(t => t.status === 'submitted');
            if (ps.length + pt.length === 0) {
                list.innerHTML = '<div class="empty-state"><div class="empty-state-icon">‚úÖ</div><p>All caught up!</p></div>';
                return;
            }
            let html = '';
            ps.forEach(s => {
                const c = chores.find(x => x.id === s.choreId);
                const m = familyMembers.find(x => x.userId === s.userId);
                html += `
                    <div class="card pending" onclick="showReview('${s.id}', 'chore')">
                        <div class="card-header">
                            <div class="card-title">üßπ ${c?.name || 'Unknown'}</div>
                            <span class="card-badge points">${c?.points || 0} pts</span>
                        </div>
                        <div class="card-body"><p><strong>By:</strong> ${m?.displayName || 'Unknown'}</p>${s.notes ? `<p>${s.notes}</p>` : ''}</div>
                    </div>
                `;
            });
            pt.forEach(t => {
                const m = familyMembers.find(x => x.userId === t.submittedBy);
                html += `
                    <div class="card pending" onclick="showReview('${t.id}', 'task')">
                        <div class="card-header">
                            <div class="card-title">üìã ${t.title}</div>
                            <span class="card-badge points">${t.points} pts</span>
                        </div>
                        <div class="card-body"><p><strong>By:</strong> ${m?.displayName || 'Unknown'}</p></div>
                    </div>
                `;
            });
            list.innerHTML = html;
        }

        function updateMembers() {
            const list = document.getElementById('familyMembersList');
            list.innerHTML = familyMembers.map(m => {
                const io = m.userId === currentFamily.ownerId;
                const cr = currentMember.role === 'parent' && !io;
                return `
                    <div class="member-item">
                        <div class="member-info">
                            <div class="member-name">${m.displayName}</div>
                            <div class="member-email">${m.email}</div>
                        </div>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <span class="member-role ${m.role}">${m.role}</span>
                            <span class="member-status ${m.status}">${m.status}</span>
                            ${cr ? `<button class="remove-btn" onclick="removeMember('${m.id}')">Remove</button>` : ''}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function updateAssignees() {
            const am = familyMembers.filter(m => m.status === 'active');
            document.getElementById('taskAssignee').innerHTML = '<option value="">Select...</option>' + 
                am.map(m => `<option value="${m.userId}">${m.displayName}</option>`).join('');
        }

        window.addChore = async () => {
            const name = document.getElementById('choreName').value.trim();
            if (!name) return alert('Enter chore name');
            try {
                await addDoc(collection(db, 'chores'), {
                    familyId: currentFamily.id, name, description: document.getElementById('choreDescription').value.trim(),
                    points: selectedPoints, frequency: document.getElementById('choreFrequency').value,
                    assignedTo: [], createdBy: currentUser.uid, createdAt: serverTimestamp(), isActive: true
                });
                closeModal('addChoreModal');
                document.getElementById('choreName').value = ''; document.getElementById('choreDescription').value = '';
            } catch (e) { console.error(e); alert('Failed to add chore'); }
        };

        window.addTask = async () => {
            const title = document.getElementById('taskTitle').value.trim();
            const assignedTo = document.getElementById('taskAssignee').value;
            if (!title || !assignedTo) return alert('Fill all fields');
            try {
                await addDoc(collection(db, 'tasks'), {
                    familyId: currentFamily.id, title, points: selectedTaskPoints, assignedTo,
                    createdBy: currentUser.uid, status: 'open', createdAt: serverTimestamp()
                });
                closeModal('addTaskModal');
                document.getElementById('taskTitle').value = ''; document.getElementById('taskAssignee').value = '';
            } catch (e) { console.error(e); alert('Failed to add task'); }
        };

        window.addFamilyMember = async () => {
            const email = document.getElementById('memberEmail').value.trim().toLowerCase();
            const name = document.getElementById('memberName').value.trim();
            const role = document.getElementById('memberRole').value;
            if (!email || !name) return alert('Fill all fields');
            if (familyMembers.find(m => m.email === email)) return alert('Email already exists');
            try {
                await addDoc(collection(db, 'familyMembers'), {
                    familyId: currentFamily.id, userId: null, email, displayName: name, role, status: 'pending',
                    invitedAt: serverTimestamp(), settings: { streaksEnabled: true }
                });
                closeModal('addMemberModal');
                document.getElementById('memberEmail').value = ''; document.getElementById('memberName').value = '';
                alert(`Invite sent to ${email}`);
            } catch (e) { console.error(e); alert('Failed to add member'); }
        };

        window.showCompleteChore = (id) => {
            selectedChore = chores.find(c => c.id === id);
            if (!selectedChore) return;
            document.getElementById('completeChoreInfo').innerHTML = `
                <div class="card-body"><p><strong>Chore:</strong> ${selectedChore.name}</p><p><strong>Points:</strong> ${selectedChore.points}</p></div>
            `;
            document.getElementById('choreNotes').value = '';
            showModal('completeChoreModal');
        };

        window.submitChoreCompletion = async () => {
            if (!selectedChore) return;
            try {
                await addDoc(collection(db, 'choreSubmissions'), {
                    familyId: currentFamily.id, choreId: selectedChore.id, userId: currentUser.uid,
                    submittedAt: serverTimestamp(), status: 'pending', notes: document.getElementById('choreNotes').value.trim()
                });
                closeModal('completeChoreModal'); selectedChore = null; alert('Submitted!');
            } catch (e) { console.error(e); alert('Failed to submit'); }
        };

        window.completeTask = async (id) => {
            const t = tasks.find(x => x.id === id);
            if (!t || t.assignedTo !== currentUser.uid) return;
            if (confirm(`Mark "${t.title}" complete?`)) {
                try {
                    await updateDoc(doc(db, 'tasks', id), { status: 'submitted', submittedAt: serverTimestamp(), submittedBy: currentUser.uid });
                    alert('Submitted!');
                } catch (e) { console.error(e); alert('Failed'); }
            }
        };

        window.showReview = (id, type) => {
            if (type === 'chore') {
                selectedSubmission = { ...submissions.find(s => s.id === id), type: 'chore' };
                const c = chores.find(x => x.id === selectedSubmission.choreId);
                const m = familyMembers.find(x => x.userId === selectedSubmission.userId);
                document.getElementById('reviewInfo').innerHTML = `
                    <div class="card-body"><p><strong>Chore:</strong> ${c?.name}</p><p><strong>By:</strong> ${m?.displayName}</p><p><strong>Points:</strong> ${c?.points}</p></div>
                `;
            } else {
                const t = tasks.find(x => x.id === id);
                selectedSubmission = { ...t, type: 'task' };
                const m = familyMembers.find(x => x.userId === t.submittedBy);
                document.getElementById('reviewInfo').innerHTML = `
                    <div class="card-body"><p><strong>Task:</strong> ${t.title}</p><p><strong>By:</strong> ${m?.displayName}</p><p><strong>Points:</strong> ${t.points}</p></div>
                `;
            }
            document.getElementById('rejectionReason').value = '';
            document.getElementById('rejectionReasonGroup').style.display = 'none';
            showModal('reviewModal');
        };

        window.reviewSubmission = async (action) => {
            if (!selectedSubmission) return;
            if (action === 'reject' && !document.getElementById('rejectionReason').value.trim()) {
                document.getElementById('rejectionReasonGroup').style.display = 'block';
                return alert('Provide reason');
            }
            try {
                if (selectedSubmission.type === 'task') {
                    const t = tasks.find(x => x.id === selectedSubmission.id);
                    if (action === 'approve') {
                        await addDoc(collection(db, 'pointsLedger'), {
                            familyId: currentFamily.id, userId: t.submittedBy, points: t.points, source: 'task',
                            sourceId: t.id, awardedBy: currentUser.uid, awardedAt: serverTimestamp(), description: `Completed: ${t.title}`
                        });
                        await updateDoc(doc(db, 'tasks', t.id), { status: 'approved', reviewedBy: currentUser.uid, reviewedAt: serverTimestamp() });
                    } else {
                        await updateDoc(doc(db, 'tasks', t.id), {
                            status: 'rejected', reviewedBy: currentUser.uid, reviewedAt: serverTimestamp(),
                            rejectionReason: document.getElementById('rejectionReason').value.trim()
                        });
                    }
                } else {
                    const c = chores.find(x => x.id === selectedSubmission.choreId);
                    if (action === 'approve') {
                        await addDoc(collection(db, 'pointsLedger'), {
                            familyId: currentFamily.id, userId: selectedSubmission.userId, points: c.points, source: 'chore',
                            sourceId: selectedSubmission.id, awardedBy: currentUser.uid, awardedAt: serverTimestamp(), description: `Completed: ${c.name}`
                        });
                        await updateDoc(doc(db, 'choreSubmissions', selectedSubmission.id), {
                            status: 'approved', reviewedBy: currentUser.uid, reviewedAt: serverTimestamp(), pointsAwarded: c.points
                        });
                    } else {
                        await updateDoc(doc(db, 'choreSubmissions', selectedSubmission.id), {
                            status: 'rejected', reviewedBy: currentUser.uid, reviewedAt: serverTimestamp(),
                            rejectionReason: document.getElementById('rejectionReason').value.trim()
                        });
                    }
                }
                closeModal('reviewModal'); selectedSubmission = null; alert(action === 'approve' ? 'Approved!' : 'Rejected');
            } catch (e) { console.error(e); alert('Failed'); }
        };

        window.removeMember = async (id) => {
            const m = familyMembers.find(x => x.id === id);
            if (m && confirm(`Remove ${m.displayName}?`)) {
                try { await deleteDoc(doc(db, 'familyMembers', id)); }
                catch (e) { console.error(e); alert('Failed'); }
            }
        };

        window.switchTab = (tab) => {
            document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(t => t.classList.add('hidden'));
            
            const tabs = { chores: 'choresTab', tasks: 'tasksTab', approvals: 'approvalsTabContent', settings: 'settingsTab' };
            document.querySelector(`.nav-tab[onclick="switchTab('${tab}')"]`).classList.add('active');
            document.getElementById(tabs[tab]).classList.remove('hidden');
        };

        window.selectPoints = (p, el) => {
            selectedPoints = p;
            document.querySelectorAll('#addChoreModal .points-btn').forEach(b => b.classList.remove('selected'));
            el.classList.add('selected');
        };

        window.selectTaskPoints = (p, el) => {
            selectedTaskPoints = p;
            document.querySelectorAll('#addTaskModal .points-btn').forEach(b => b.classList.remove('selected'));
            el.classList.add('selected');
        };

        window.showModal = (id) => document.getElementById(id).classList.add('active');
        window.closeModal = (id) => document.getElementById(id).classList.remove('active');

        function showScreen(s) {
            ['login', 'setup', 'main'].forEach(x => {
                document.getElementById(x + (x === 'main' ? 'App' : 'Screen')).classList.toggle('hidden', x !== s);
            });
            if (s === 'main' && currentUser.photoURL) document.getElementById('userAvatar').src = currentUser.photoURL;
        }

        window.openDisclaimer = () => {
            document.getElementById('disclaimerDrawer').classList.add('open');
            document.getElementById('disclaimerOverlay').classList.add('active');
        };

        window.closeDisclaimer = () => {
            document.getElementById('disclaimerDrawer').classList.remove('open');
            document.getElementById('disclaimerOverlay').classList.remove('active');
        };

        // Theme management
        const themes = {
            default: { primaryStart: '#2c5f7a', primaryEnd: '#1a3a4a', accentPrimary: '#0d9488', accentSecondary: '#0f766e', accentBg: '#f0fdfa', balanceStart: '#0d9488', balanceEnd: '#0f766e' },
            classic: { primaryStart: '#000000', primaryEnd: '#000000', accentPrimary: '#000000', accentSecondary: '#000000', accentBg: '#ffffff', balanceStart: '#000000', balanceEnd: '#000000' },
            monochrome: { primaryStart: '#000000', primaryEnd: '#1a1a1a', accentPrimary: '#ef4444', accentSecondary: '#dc2626', accentBg: '#fee2e2', balanceStart: '#000000', balanceEnd: '#1a1a1a' },
            pink: { primaryStart: '#fce7f3', primaryEnd: '#fbcfe8', accentPrimary: '#ec4899', accentSecondary: '#db2777', accentBg: '#fce7f3', balanceStart: '#fce7f3', balanceEnd: '#fbcfe8' },
            purple: { primaryStart: '#581c87', primaryEnd: '#3b0764', accentPrimary: '#a855f7', accentSecondary: '#9333ea', accentBg: '#f3e8ff', balanceStart: '#a855f7', balanceEnd: '#9333ea' },
            ocean: { primaryStart: '#0c4a6e', primaryEnd: '#082f49', accentPrimary: '#0ea5e9', accentSecondary: '#0284c7', accentBg: '#e0f2fe', balanceStart: '#0ea5e9', balanceEnd: '#0284c7' },
            royal: { primaryStart: '#1e3a8a', primaryEnd: '#1e1b4b', accentPrimary: '#6366f1', accentSecondary: '#4f46e5', accentBg: '#e0e7ff', balanceStart: '#6366f1', balanceEnd: '#4f46e5' },
            forest: { primaryStart: '#064e3b', primaryEnd: '#022c22', accentPrimary: '#10b981', accentSecondary: '#059669', accentBg: '#d1fae5', balanceStart: '#10b981', balanceEnd: '#059669' },
            sunset: { primaryStart: '#7c2d12', primaryEnd: '#431407', accentPrimary: '#f97316', accentSecondary: '#ea580c', accentBg: '#ffedd5', balanceStart: '#f97316', balanceEnd: '#ea580c' }
        };

        window.showThemeModal = () => document.getElementById('themeModal').classList.add('active');

        window.setTheme = (themeName) => {
            const theme = themes[themeName];
            if (!theme) return;
            const root = document.documentElement;
            root.style.setProperty('--primary-start', theme.primaryStart);
            root.style.setProperty('--primary-end', theme.primaryEnd);
            root.style.setProperty('--accent-primary', theme.accentPrimary);
            root.style.setProperty('--accent-secondary', theme.accentSecondary);
            root.style.setProperty('--accent-bg', theme.accentBg);
            root.style.setProperty('--balance-start', theme.balanceStart);
            root.style.setProperty('--balance-end', theme.balanceEnd);
            localStorage.setItem('idkChoresTheme', themeName);
            closeModal('themeModal');
        };

        // Load saved theme
        window.addEventListener('DOMContentLoaded', () => {
            const savedTheme = localStorage.getItem('idkChoresTheme') || 'default';
            if (savedTheme && themes[savedTheme]) setTheme(savedTheme);
        });
    </script>
</body>
</html>
